<!DOCTYPE html><html lang="zh-TW" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width,initial-scale=1"><title>AFL++: Combining Incremental Steps of Fuzzing Research | LJC's BLOG</title><meta name="keywords" content="papper notes"><meta name="author" content="LJC"><meta name="copyright" content="LJC"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="ä½œè€…ï¼šAndrea Fioraldiâ€ , Dominik Maierâ€¡, Heiko EiÃŸfeldt, Marc HeuseÂ§ å•ä½ï¼šâ€ Sapienza University of Romeç½—é©¬å¤§å­¦, â€¡TU BerlinæŸæ—å·¥ä¸šå¤§å­¦,Â§The Hackerâ€™s Choice ä¼šè®®ï¼šUSENIX Workshop 2020 é“¾æ¥ï¼šhttps:&#x2F;&#x2F;www.usenix.org&#x2F;system&#x2F;fi">
<meta property="og:type" content="article">
<meta property="og:title" content="AFL++: Combining Incremental Steps of Fuzzing Research">
<meta property="og:url" content="https://ljcppp.github.io/2021/05/15/AFL-Combining-Incremental-Steps-of-Fuzzing-Research/index.html">
<meta property="og:site_name" content="LJC&#39;s BLOG">
<meta property="og:description" content="ä½œè€…ï¼šAndrea Fioraldiâ€ , Dominik Maierâ€¡, Heiko EiÃŸfeldt, Marc HeuseÂ§ å•ä½ï¼šâ€ Sapienza University of Romeç½—é©¬å¤§å­¦, â€¡TU BerlinæŸæ—å·¥ä¸šå¤§å­¦,Â§The Hackerâ€™s Choice ä¼šè®®ï¼šUSENIX Workshop 2020 é“¾æ¥ï¼šhttps:&#x2F;&#x2F;www.usenix.org&#x2F;system&#x2F;fi">
<meta property="og:locale" content="zh_TW">
<meta property="og:image" content="https://ljcppp.github.io/img/Big_Sur_Simple.png">
<meta property="article:published_time" content="2021-05-15T07:14:52.000Z">
<meta property="article:modified_time" content="2021-06-09T07:16:59.374Z">
<meta property="article:author" content="LJC">
<meta property="article:tag" content="papper notes">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://ljcppp.github.io/img/Big_Sur_Simple.png"><link rel="shortcut icon" href="/img/favicon.ico"><link rel="canonical" href="https://ljcppp.github.io/2021/05/15/AFL-Combining-Incremental-Steps-of-Fuzzing-Research/"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free/css/all.min.css" media="print" onload="this.media='all'"><script>const GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  translate: undefined,
  noticeOutdate: {"limitDay":365,"position":"top","messagePrev":"It has been","messageNext":"days since the last update, the content of the article may be outdated."},
  highlight: {"plugin":"highlighjs","highlightCopy":true,"highlightLang":true},
  copy: {
    success: 'è¤‡è£½æˆåŠŸ',
    error: 'è¤‡è£½éŒ¯èª¤',
    noSupport: 'ç€è¦½å™¨ä¸æ”¯æ´'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '',
  date_suffix: {
    just: 'å‰›å‰›',
    min: 'åˆ†é˜å‰',
    hour: 'å°æ™‚å‰',
    day: 'å¤©å‰',
    month: 'å€‹æœˆå‰'
  },
  copyright: {"limitCount":50,"languages":{"author":"ä½œè€…: LJC","link":"é€£çµ: ","source":"ä¾†æº: LJC's BLOG","info":"è‘—ä½œæ¬Šæ­¸ä½œè€…æ‰€æœ‰ã€‚å•†æ¥­è½‰è¼‰è«‹è¯çµ¡ä½œè€…ç²å¾—æˆæ¬Šï¼Œéå•†æ¥­è½‰è¼‰è«‹è¨»æ˜å‡ºè™•ã€‚"}},
  lightbox: 'fancybox',
  Snackbar: undefined,
  source: {
    jQuery: 'https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js',
    justifiedGallery: {
      js: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/js/jquery.justifiedGallery.min.js',
      css: 'https://cdn.jsdelivr.net/npm/justifiedGallery/dist/css/justifiedGallery.min.css'
    },
    fancybox: {
      js: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js',
      css: 'https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.css'
    }
  },
  isPhotoFigcaption: false,
  islazyload: false,
  isanchor: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = { 
  isPost: true,
  isHome: false,
  isHighlightShrink: true,
  isToc: true,
  postUpdate: '2021-06-09 15:16:59'
}</script><noscript><style type="text/css">
  #nav {
    opacity: 1
  }
  .justified-gallery img {
    opacity: 1
  }

  #recent-posts time,
  #post-meta time {
    display: inline !important
  }
</style></noscript><script>(win=>{
    win.saveToLocal = {
      set: function setWithExpiry(key, value, ttl) {
        if (ttl === 0) return
        const now = new Date()
        const expiryDay = ttl * 86400000
        const item = {
          value: value,
          expiry: now.getTime() + expiryDay,
        }
        localStorage.setItem(key, JSON.stringify(item))
      },

      get: function getWithExpiry(key) {
        const itemStr = localStorage.getItem(key)

        if (!itemStr) {
          return undefined
        }
        const item = JSON.parse(itemStr)
        const now = new Date()

        if (now.getTime() > item.expiry) {
          localStorage.removeItem(key)
          return undefined
        }
        return item.value
      }
    }
  
    win.getScript = url => new Promise((resolve, reject) => {
      const script = document.createElement('script')
      script.src = url
      script.async = true
      script.onerror = reject
      script.onload = script.onreadystatechange = function() {
        const loadState = this.readyState
        if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
        script.onload = script.onreadystatechange = null
        resolve()
      }
      document.head.appendChild(script)
    })
  
      win.activateDarkMode = function () {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      win.activateLightMode = function () {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }
      const t = saveToLocal.get('theme')
    
          if (t === 'dark') activateDarkMode()
          else if (t === 'light') activateLightMode()
        
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    })(window)</script><meta name="generator" content="Hexo 5.4.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">è¼‰å…¥ä¸­...</div></div></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="author-avatar"><img class="avatar-img" src="/img/avatar.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="site-data"><div class="data-item is-center"><div class="data-item-link"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">8</div></a></div></div><div class="data-item is-center"><div class="data-item-link"><a href="/tags/"><div class="headline">æ¨™ç±¤</div><div class="length-num">5</div></a></div></div></div><hr/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('/img/Big_Sur_Simple.png')"><nav id="nav"><span id="blog_name"><a id="site-name" href="/">LJC's BLOG</a></span><div id="menus"><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> Home</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> Archives</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> Tags</span></a></div><div class="menus_item"><a class="site-page" href="/categories/"><i class="fa-fw fas fa-folder-open"></i><span> Categories</span></a></div><div class="menus_item"><a class="site-page" href="/link/"><i class="fa-fw fas fa-link"></i><span> Link</span></a></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> About</span></a></div></div><div id="toggle-menu"><a class="site-page"><i class="fas fa-bars fa-fw"></i></a></div></div></nav><div id="post-info"><h1 class="post-title">AFL++: Combining Incremental Steps of Fuzzing Research</h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">ç™¼è¡¨æ–¼</span><time class="post-meta-date-created" datetime="2021-05-15T07:14:52.000Z" title="ç™¼è¡¨æ–¼ 2021-05-15 15:14:52">2021-05-15</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">æ›´æ–°æ–¼</span><time class="post-meta-date-updated" datetime="2021-06-09T07:16:59.374Z" title="æ›´æ–°æ–¼ 2021-06-09 15:16:59">2021-06-09</time></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-pv-cv"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">é–±è®€é‡:</span><span id="busuanzi_value_page_pv"></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><blockquote>
<p>ä½œè€…ï¼šAndrea Fioraldiâ€ , Dominik Maierâ€¡, Heiko EiÃŸfeldt, Marc HeuseÂ§</p>
<p>å•ä½ï¼šâ€ Sapienza University of Romeç½—é©¬å¤§å­¦, â€¡TU BerlinæŸæ—å·¥ä¸šå¤§å­¦,Â§The Hackerâ€™s Choice</p>
<p>ä¼šè®®ï¼šUSENIX Workshop 2020</p>
<p>é“¾æ¥ï¼š<a target="_blank" rel="noopener" href="https://www.usenix.org/system/files/woot20-paper-fioraldi.pdf">https://www.usenix.org/system/files/woot20-paper-fioraldi.pdf</a></p>
</blockquote>
<h2 id="Introduction">Introduction</h2>
<p>è¿‘å¹´æ¥ï¼Œæ¨¡ç³Šæµ‹è¯•åœ¨ä¿¡æ¯å®‰å…¨é¢†åŸŸå¼•å‘äº†å¹¿æ³›å…³æ³¨ï¼Œå¹¶ä¿ƒè¿›äº†å„ä¸ªé¢†åŸŸçš„è¿›æ­¥ã€‚ åœ¨ Shoshitaishvili ç­‰äººè¿›è¡Œçš„æµ‹è¯•ä¸­ï¼Œç¬¦å·è¾…åŠ©çš„æ¨¡ç³Šæµ‹è¯•è¯†åˆ«å‡ºçš„æ¼æ´å‡ ä¹æ˜¯ç¬¦å·æ‰§è¡Œçš„ä¸‰å€ã€‚</p>
<p>AFLæ˜¯æœ€å…·ç››åçš„fuzzingå·¥å…·ï¼ŒåŸºäºAFLçš„ç ”ç©¶ä¹Ÿå±‚å‡ºä¸ç©·ï¼Œä½†è¿™äº›æŠ€æœ¯å¾€å¾€æ˜¯æ­£äº¤å¼ã€ç‹¬ç«‹åœ°å‘å±•ã€‚</p>
<p>å› æ­¤ï¼š</p>
<ol>
<li>å°†è¿™äº›å‰æ²¿æ–°é¢–çš„fuzzingæŠ€æœ¯ç»“åˆèµ·æ¥æ˜¯ä¸€ä»¶å¾ˆå›°éš¾çš„äº‹æƒ…</li>
<li>è€Œè¯„ä¼°è¿™äº›ä¸åŒç»´åº¦çš„fuzzingæŠ€æœ¯ä¹Ÿæ˜¯ä¸€ä»¶å¾ˆå›°éš¾çš„äº‹</li>
</ol>
<p>æœ¬æ–‡æå‡ºäº†ä¸€ä¸ªæ–°çš„fuzzingæ¡†æ¶ AFL++è§£å†³ä¸Šé¢çš„é—®é¢˜ã€‚</p>
<ol>
<li>AFL++æä¾›äº†ä¸€ä¸ªå¯ç”¨çš„fuzzingå·¥å…·ï¼Œç»“åˆäº†è®¸å¤šå‰æ²¿fuzzingæŠ€æœ¯</li>
<li>AFL++è¿˜æä¾›äº†ä¸€ç§æ–°é¢–çš„å¯è‡ªå®šä¹‰çš„å˜å¼‚APIï¼ˆCustom Mutator APIï¼‰ï¼Œç ”ç©¶äººå‘˜èƒ½å¤Ÿè½»æ¾å°†è‡ªå·±è®¾è®¡çš„Mutatoråº”ç”¨åˆ°AFL++ä¸Šï¼Œæˆ–å’Œå…¶ä»–Mutatorsç»“åˆèµ·æ¥ã€‚</li>
<li>è¿™ç¯‡è®ºæ–‡è¿˜è¯„ä¼°äº†è®¸å¤šç»“åˆèµ·æ¥çš„fuzzingæŠ€æœ¯ç»„åˆï¼Œè¯„ä¼°ç»“æœä½“ç°äº†fuzzingæŠ€æœ¯çš„target-dependency.</li>
</ol>
<h2 id="2-State-of-the-Art">2 State-of-the-Art</h2>
<p>è§£é‡Šä¸€äº›å’ŒAFLç›¸å…³çš„æ¦‚å¿µå’Œè¿‘äº›å¹´ç ”ç©¶ã€‚</p>
<h3 id="2-1-American-Fuzzy-Lop">2.1 American Fuzzy Lop</h3>
<p>AFLæ˜¯ä¸€ç§åŸºäºè¦†ç›–ç‡åé¦ˆï¼ˆcoverage- guidedï¼‰çš„fuzzå·¥å…·ã€‚</p>
<p>AFLçš„å·¥ä½œæµç¨‹å¦‚ä¸‹ï¼š</p>
<ol>
<li>ç¼–è¯‘æ—¶å¯¹æºç è¿›è¡Œæ’æ¡©ï¼Œä»¥è®°å½•ä»£ç è¦†ç›–ç‡ï¼ˆCode Coverageï¼‰</li>
<li>åˆå§‹åŒ–ä¸€äº›è¾“å…¥æ–‡ä»¶ï¼ŒåŠ å…¥åˆ°è¾“å…¥é˜Ÿåˆ—ï¼ˆqueueï¼‰</li>
<li>åœ¨é˜Ÿåˆ—ä¸­æŒ‰ç…§ä¸€å®šç­–ç•¥é€‰æ‹©ç§å­ï¼ˆseedï¼‰ï¼Œå¹¶è¿›è¡Œå¤§é‡çš„çªå˜ï¼ˆmutationï¼‰ï¼Œå¾—åˆ°å¤§é‡çš„å˜å¼‚æ–‡ä»¶</li>
<li>å¦‚æœè¯¥å˜å¼‚æ–‡ä»¶è§¦å‘äº†æ–°çš„æ‰§è¡Œè·¯å¾„ï¼Œåˆ™å°†å…¶ä¿å­˜ä¸‹æ¥ï¼ŒåŠ å…¥åˆ°é˜Ÿåˆ—ä¸­ã€‚</li>
<li>goto 2</li>
</ol>
<p>ä¸Šè¿°è¿‡ç¨‹ä¼šä¸€ç›´è¿›è¡Œä¸‹å»ï¼Œå…¶ä¸­è§¦å‘çš„crashä¼šè¢«è®°å½•ä¸‹æ¥ï¼Œä»¥ä¾¿åé¢åˆ†æç¨‹åºæ¼æ´ã€‚</p>
<p><img src="https://i.loli.net/2021/04/19/FXi5zYwlkDJ38W2.png" alt="image-20210419163141467"></p>
<h4 id="2-1-1-Coverage-Guided-Feedback">2.1.1 Coverage Guided Feedback</h4>
<p>AFLçš„è¦†ç›–åé¦ˆæ˜¯ä¸€ç§æ··åˆåº¦é‡ï¼Œå®ƒå°†è¾¹è¦†ç›–ä¸æ¯æ¡è¾¹åœ¨ä¸€æ¬¡è¿è¡Œä¸­è¢«æ‰§è¡Œçš„æ¬¡æ•°ç›¸ç»“åˆã€‚å¦‚æœä¸€ä¸ªè¾“å…¥æ¢ç´¢äº†è‡³å°‘ä¸€ä¸ªæ–°çš„è¾¹ï¼Œé‚£ä¹ˆå®ƒå°±è¢«è®¤ä¸ºæ˜¯æœ‰æ„ä¹‰çš„(å³ï¼Œä¿å­˜åˆ°é˜Ÿåˆ—ä¸­)ã€‚</p>
<p>å¯¹äºé˜Ÿåˆ—ä¸­çš„æ¯ä¸ªæµ‹è¯•ç”¨ä¾‹ï¼ŒAFLè¿˜è¯•å›¾å‡å°æµ‹è¯•ç”¨ä¾‹çš„å¤§å°å¹¶æé«˜ç›®æ ‡çš„é€Ÿåº¦ï¼ŒåŒæ—¶åœ¨ä¿®å‰ªæ—¶ä¿æŒå®Œæ•´çš„è¦†ç›–ã€‚</p>
<h4 id="2-1-2-Mutation">2.1.2 Mutation</h4>
<p>AFLä¸­çš„Mutationä¸»è¦åˆ†ä¸ºä¸¤ç§ï¼Œä¸€ç§æ˜¯<strong>deterministic stage</strong>ï¼Œç¡®å®šæ€§çªå˜æ˜¯æµ‹è¯•ç”¨ä¾‹å†…å®¹ä¸Šçš„å•ä¸€ç¡®å®šæ€§çªå˜ï¼Œå¦‚ä½ç¿»è½¬ã€åŠ æ³•ç­‰ï¼›å¦ä¸€ç§æ˜¯<strong>havoc stage</strong>ï¼Œçªå˜æ˜¯éšæœºå †å çš„ï¼ŒåŒ…æ‹¬å¯¹æµ‹è¯•ç”¨ä¾‹å¤§å°çš„æ›´æ”¹ã€‚</p>
<h4 id="2-1-3-Forkserver">2.1.3 Forkserver</h4>
<p>ä¸ºäº†é¿å…<code>execve()</code>çš„å¼€é”€ï¼ŒAFLä½¿ç”¨æ‰€è°“çš„forkserverã€‚Fuzzeré€šè¿‡è¿›ç¨‹é—´é€šä¿¡æœºåˆ¶ï¼Œå‘ç›®æ ‡æ³¨å…¥forkserverã€‚å¦‚ä¸‹å›¾æ‰€ç¤ºã€‚</p>
<p><img src="https://i.loli.net/2021/04/20/THknsmtyGepd4K7.png" alt="image-20210420132958275"></p>
<p>å½“fuzzeråœ¨æ‰§è¡Œç›®æ ‡ç¨‹åºå‰ï¼Œä¼šå…ˆæ‰§è¡Œfork()å‘½ä»¤ï¼Œå¾—åˆ°ä¸€ä¸ªå­è¿›ç¨‹ã€‚</p>
<p>å­è¿›ç¨‹å†é€šè¿‡execve()æŒ‡ä»¤æ‰§è¡Œç›®æ ‡ç¨‹åºï¼Œè€Œexecve()å‘½ä»¤æœ‰ä¸€ä¸ªå¾ˆç‰¹åˆ«çš„åœ°æ–¹ï¼Œä»–ä¼šç”¨è¿™ä¸ªç›®æ ‡ç¨‹åºçš„æ˜ åƒè¦†ç›–æ‰å­è¿›ç¨‹çš„æ˜ åƒã€‚</p>
<p>å› æ­¤ï¼Œæ­¤æ—¶çš„fuzzer fork()å‡ºçš„å­è¿›ç¨‹å°±å˜æˆäº†æ’è¿‡æ¡©çš„ç›®æ ‡ç¨‹åºï¼Œä¹Ÿå°±æ˜¯forkserverã€‚</p>
<p>å½“fuzzeræƒ³è¦æ‰§è¡Œç›®æ ‡ç¨‹åºæ—¶ï¼Œå°±å’Œforkserveré€šä¿¡ï¼Œå°†forkç›®æ ‡ç¨‹åºçš„ä»»åŠ¡äº¤ç»™forkserverï¼Œè¿™æ ·å°±æå¤§çš„æé«˜äº†fuzzerçš„æ‰§è¡Œæ•ˆç‡ã€‚</p>
<h4 id="2-1-4-Persistent-Mode">2.1.4 Persistent Mode</h4>
<p>æŒä¹…æ¨¡å¼æå¤§åœ°æé«˜äº†æ€§èƒ½ï¼Œå› ä¸ºç›®æ ‡ä¸ä¼šforkæ¯ä¸ªæµ‹è¯•ç”¨ä¾‹ã€‚ä¸€èˆ¬æ˜¯å¯¹ç¨‹åºpatchä¸€ä¸ªå¾ªç¯ï¼Œç„¶åæ¯æ¬¡è¿­ä»£ä¸­æ‰§è¡Œä¸€ä¸ªæµ‹è¯•ç”¨ä¾‹ã€‚æå¤§å‡å°‘äº†forkçš„å¼€é”€ã€‚</p>
<h3 id="2-2-Smart-Scheduling">2.2 Smart Scheduling</h3>
<p>Schedulersçš„ç›®æ ‡æ˜¯é€šè¿‡æ™ºèƒ½çš„æµ‹è¯•ç”¨ä¾‹é€‰æ‹©æ¥æé«˜æ€»ä½“è¦†ç›–ç‡å’Œé”™è¯¯æ£€æµ‹ã€‚</p>
<h4 id="2-2-1-AFLFast">2.2.1 AFLFast</h4>
<p>AFLFastä¸»è¦æ˜¯ä»ç§å­è°ƒåº¦çš„æ–¹å‘æ”¹è¿›AFLã€‚</p>
<p>AFLFastè§‚å¯Ÿåˆ°ç§å­å¤§å¤šæ•°ç”Ÿæˆçš„è¾“å…¥éƒ½ç»å†äº†ç›¸åŒçš„é«˜é¢‘è·¯å¾„ï¼Œå› æ­¤æƒ³è¦è®¾è®¡ä¸€äº›ç­–ç•¥èƒ½å¤Ÿfocus onä¸€äº›ä½é¢‘è·¯å¾„ã€‚</p>
<p>ä»–ä»¬ä¸»è¦å…³æ³¨ä¸¤ä¸ªé—®é¢˜ï¼š</p>
<ol>
<li>ä¸ºäº†å¼ºè°ƒä½é¢‘è·¯å¾„ï¼Œfuzzeråº”è¯¥æŒ‰ä»€ä¹ˆé¡ºåºæŒ‘é€‰ç§å­ï¼Ÿ</li>
<li>æˆ‘ä»¬èƒ½è°ƒæ•´æ¯ä¸ªç§å­äº§ç”Ÿçš„è¾“å…¥ï¼Œå³å¯ä»¥ç”Ÿæˆå¤šå°‘å˜å¼‚æ–‡ä»¶ï¼ˆenergyï¼‰å—ï¼Ÿ</li>
</ol>
<p>ä½œè€…é€šè¿‡ä¸€ç»„æ–°çš„æœç´¢ç­–ç•¥æ¥è§£å†³ç¬¬ä¸€ä¸ªé—®é¢˜ã€‚é€šè¿‡å¼•å…¥å…­ç§åŠŸç‡è®¡åˆ’ï¼Œå¹¶æ ¹æ®æ¨¡ç³Šè¿‡ç¨‹ä¸­æ”¶é›†çš„å‚æ•°æ¥è®¡ç®—èƒ½é‡è§£å†³ç¬¬äºŒä¸ªé—®é¢˜ã€‚</p>
<h4 id="2-2-2-MOpt">2.2.2 MOpt</h4>
<p>MOptæ˜¯ä»å˜å¼‚è°ƒåº¦çš„è§’åº¦æå‡fuzzçš„æ•ˆç‡ã€‚MOptä½¿ç”¨ç²’å­ç¾¤ä¼˜åŒ–ç®—æ³•æ¥å¯¹é—®é¢˜å»ºæ¨¡ï¼Œè¿™ç§ç®—æ³•æé«˜äº†fuzzerå¿«é€Ÿå‘ç°è¦†ç›–çš„èƒ½åŠ›ã€‚</p>
<p>åœ¨MOptçš„å·¥ä½œæµç¨‹ä¸­ï¼Œä¸»è¦æœ‰ä¸¤ä¸ªæ ¸å¿ƒæ¨¡å—ã€‚ä¸€ä¸ªæ˜¯Pilotæ¨¡å—ï¼Œå¦ä¸€ä¸ªæ˜¯Coreæ¨¡å—ã€‚</p>
<p>Pilotæ¨¡å—ï¼šè¯„ä¼°æ¯ä¸€ä¸ªç²’å­ç¾¤ï¼Œä¹Ÿå°±æ˜¯è¯¥mutationsçš„æ¦‚ç‡åˆ†å¸ƒçš„fuzzæ•ˆç‡ã€‚</p>
<p>Coreæ¨¡å—ï¼šä½¿ç”¨Pilotæ¨¡å—è¯„ä¼°å‡ºçš„æ•ˆç‡æœ€é«˜çš„mutationç­–ç•¥ æ¥fuzzã€‚</p>
<h3 id="2-3-Bypassing-Roadblocks">2.3 Bypassing Roadblocks</h3>
<p>è¦†ç›–å¼•å¯¼çš„fuzzeræœ‰æ—¶å€™ä¼šé‡åˆ°ä¸€äº›é˜»ç¢å…¶æ¢ç´¢çš„éšœç¢ï¼Œæ¯”å¦‚å­—ç¬¦ä¸²æ¯”è¾ƒå’Œæ ¡éªŒå’Œã€‚</p>
<h4 id="2-3-1-LAF-Intel">2.3.1 LAF-Intel</h4>
<p>LAF- Intelçš„æ€è·¯æ˜¯ï¼ŒæŠŠè¿™äº›æ¯”è¾ƒéš¾çš„ã€æ¯”è¾ƒä¸€è¿ä¸²å­—ç¬¦çš„æ¯”è¾ƒåˆ’åˆ†ä¸ºå¤šä¸ªå•å­—èŠ‚çš„æ¯”è¾ƒã€‚è¿™æ ·å¯ä»¥è®©ç¨‹åºå—çš„åˆ’åˆ†ç²’åº¦æ›´ç»†ï¼Œå½“ä½ æ¯åŒ¹é…åˆ°ä¸€ä¸ªå­—èŠ‚æ—¶ï¼Œå°±è¢«è®¤ä¸ºæ˜¯interestingï¼Œè¢«ä¿å­˜åˆ°é˜Ÿåˆ—ä¸­ï¼Œä»¥åå¯ä»¥ç»§ç»­fuzzï¼Œè¿™æ ·ï¼Œfuzzerå°±å¯ä»¥ä¸€æ­¥ä¸€æ­¥çš„è§£å†³è¿™ä¸ªroadblockã€‚</p>
<p>å…·ä½“æ¥è¯´ï¼ŒLAF-Intelï¼š</p>
<ol>
<li>å°†&gt;=(å’Œ&lt;=)è¿ç®—ç¬¦ç®€åŒ–ä¸º&gt;(&lt;)å’Œ==æ¯”è¾ƒé“¾</li>
<li>å°†æœ‰ç¬¦å·æ•´æ•°æ¯”è¾ƒé“¾æ”¹ä¸ºä»…ç¬¦å·æ¯”è¾ƒé“¾å’Œæ— ç¬¦å·æ¯”è¾ƒé“¾</li>
<li>å°†æ‰€æœ‰ä½å®½ä¸º64ä½ã€32ä½å’Œ16ä½çš„æ— ç¬¦å·æ•´æ•°æ¯”è¾ƒé“¾æ‹†åˆ†ä¸º8ä½å¤šé‡æ¯”è¾ƒé“¾</li>
</ol>
<h4 id="2-3-2-RedQueen">2.3.2 RedQueen</h4>
<ol>
<li>
<p>å¯¹è¾“å…¥è¿›è¡ŒæŸ“è‰²</p>
</li>
<li>
<p>æ ¹æ®æŒ‡å®šæ¡ä»¶ï¼Œè¯†åˆ«è¿™äº›åƒchecksumæ¯”è¾ƒçš„æŒ‡ä»¤ï¼Œhookä½ã€‚</p>
</li>
<li>
<p>ç„¶åå°±ç”¨<code>cmp al, al</code> patchåŸç¨‹åºï¼Œè¿™æ ·å°±è®©è¿™äº›checksumçš„åˆ¤æ–­ä¸€å®šä¸ºæ­£ã€‚</p>
<p><img src="https://z3.ax1x.com/2021/04/09/cNjq4U.png" alt="cNjq4U.png"></p>
<p>ä½†è¿™æ ·çš„patchå°±ä¼šå¸¦æ¥false positiveï¼Œå³è¿™äº›è¾“å…¥çš„æ‰§è¡Œè·¯å¾„å¯èƒ½å¹¶ä¸æ˜¯è¿™æ ·çš„ã€‚</p>
</li>
<li>
<p>RedQueenå°±ä¼šåœ¨ä¹‹åè¿›è¡Œè¾“å…¥éªŒè¯ï¼Œå¹¶ä¿®å¤ä»–ä»¬ã€‚</p>
</li>
<li>
<p>åœ¨fixé˜¶æ®µï¼Œå…¶å®å°±æ˜¯ç”¨magic bytesçš„æ–¹æ³•ï¼Œå¯¹checksumçš„ä½ç½®è¿›è¡Œ</p>
</li>
</ol>
<h3 id="2-4-Mutate-Structured-Inputs">2.4 Mutate Structured Inputs</h3>
<p>Fuzzerçš„å¸¸è§é—®é¢˜æ˜¯ï¼Œå¯èƒ½ä¼šç”Ÿæˆå¤§éƒ¨åˆ†æ— æ•ˆè¾“å…¥ã€‚ä¸€ç§æ–¹æ¡ˆæ˜¯ä½¿ç”¨è¾“å…¥æ¨¡å‹ï¼Œä»è€Œæœ‰æ•ˆå‡å°‘ç”Ÿæˆçš„è¾“å…¥ç©ºé—´ã€‚</p>
<h4 id="2-4-1-AFLSmart">2.4.1 AFLSmart</h4>
<p>AFLSmartå°†AFLå’ŒPeachç»“åˆèµ·æ¥ï¼ŒAFLSmartçš„è¾“å…¥ä¸ºPeach pitsæ ¼å¼ï¼Œä¸€ç§xmlæ–‡ä»¶ã€‚</p>
<p>AFLSmart å°†ç§å­éƒ½è¡¨ç¤ºä¸ºPeach pitsæ ¼å¼ï¼Œè¿™æ ·ï¼Œå°±å¯ä»¥åŸºäºè¿™äº›å—è¿›è¡Œå˜å¼‚ï¼Œè€Œä¸éœ€è¦åŸºäºæ¯”ç‰¹çº§çš„ å˜å¼‚ã€‚</p>
<h2 id="3-A-New-Baseline-for-Fuzzing">3 A New Baseline for Fuzzing</h2>
<p>AFL++å°±å°†ä¸Šè¿°æåˆ°çš„è¯¸å¤šfuzzingæŠ€æœ¯éƒ½ç»“åˆåœ¨ä¸€èµ·ï¼Œå¹¶æä¾›äº†ä¸€ç§å¯ä¾›æ‰©å±•çš„APIã€‚</p>
<h3 id="3-1-Seed-Scheduling">3.1 Seed Scheduling</h3>
<p>AFL++çš„Seed Schedulingå°±æ˜¯åŸºäºAFLFastçš„ç§å­è°ƒåº¦ã€‚</p>
<p>AFL++çš„Power Schedulesé™¤äº†AFLFastæåˆ°çš„6ç§ï¼Œè¿˜æœ‰å¦å¤–ä¸¤ç§ï¼ŒMmoptå’ŒRareã€‚</p>
<p>Mmoptä¸»è¦å…³æ³¨é‚£äº›æœ€æ–°å‘ç°çš„ç§å­</p>
<p>è€ŒRareä¸»è¦å…³æ³¨é‚£äº›å…·æœ‰ç½•è§è¾¹çš„ç§å­ã€‚</p>
<h3 id="3-2-Mutators">3.2 Mutators</h3>
<h4 id="3-2-1-Custom-Mutator-API">3.2.1 Custom Mutator API</h4>
<p>è‡ªå®šä¹‰å˜å¼‚å™¨å…è®¸æ¨¡ç³Šç ”ç©¶åœ¨AFL++ä¹‹ä¸Šæ„å»ºæ–°çš„è°ƒåº¦ã€çªå˜å’Œæœ€å°åŒ–ï¼Œè€Œä¸éœ€è¦åƒç›®å‰çš„è®¸å¤šå·¥å…·é‚£æ ·æ´¾ç”Ÿå’Œä¿®è¡¥AFLã€‚ä¾‹å¦‚ï¼Œä½¿ç”¨å½“å‰çš„APIï¼ŒAFLSMARTå¯ä»¥å®Œå…¨é‡å†™ä¸ºAFL++æ’ä»¶ã€‚</p>
<p>é™¤äº†è‡ªå®šä¹‰å˜å¼‚APIï¼ŒAFL++è¿˜æä¾›äº†è‡ªå®šä¹‰å‰ªæAPIï¼Œä½†æ˜¯å¯èƒ½ç ´åå¤æ‚æ ¼å¼çš„ç»“æ„ã€‚</p>
<h4 id="3-2-2-Input-To-State-Mutator">3.2.2 Input-To-State Mutator</h4>
<p>AFL++å®ç°äº†ä¸€ä¸ªåŸºäºRedQueençš„Input-To-State(I2S)æ›¿æ¢çš„çªå˜å™¨ï¼Œå¹¶è¿›è¡Œäº†ä¸€äº›ä¼˜åŒ–ã€‚</p>
<p>é¦–å…ˆæ‰©å±•äº†æŸ“è‰²çš„æ–¹æ³•ã€‚RedQueenåœ¨æŸ“è‰²æ—¶æ˜¯ä¿æŒç¨‹åºæ‰§è¡Œè·¯å¾„ä¸å˜ï¼Œå³hash of bitmapä¸å˜ã€‚è€ŒAFL++é™¤äº†ä¿æŒç¨‹åºçš„æ‰§è¡Œè·¯å¾„ä¸å˜ï¼Œè¿˜å¯¹ç¨‹åºçš„æ‰§è¡Œæ—¶é—´åšäº†ä¸€å®šæ§åˆ¶ï¼Œè§„å®šäº†ç¨‹åºçš„æ‰§è¡Œæ—¶é—´ä¸‹ç•Œä¸º2x slowdownã€‚</p>
<p>å¦ä¸€ä¸ªæ‰©å±•æ˜¯æ¦‚ç‡fuzzingã€‚å¦‚æœfuzzeræ— æ³•ç”Ÿæˆèƒ½ç»•è¿‡æ¯”è¾ƒçš„è¾“å…¥ï¼Œé‚£ä¹ˆåœ¨ä¸‹ä¸€æ¬¡å°±ä¼šä»¥è¾ƒå°çš„æ¦‚ç‡å°è¯•ç»•è¿‡ï¼Œé˜²æ­¢åœ¨æ— æ³•è§£å†³çš„æ¯”è¾ƒä¸Šæµªè´¹å¤ªå¤šæ—¶é—´ã€‚</p>
<p><strong>æ¯”è¾ƒæ—¥å¿—è¡¨æ ¼åŒ–</strong> RedQueenä¸­é‡‡ç”¨çš„æ˜¯è™šæ‹Ÿæœºæ–­ç‚¹hookçš„cmpæŒ‡ä»¤ï¼Œå½“æ–­ç‚¹è¢«hitæ—¶ï¼Œå†æå–æŒ‡ä»¤æ“ä½œæ•°ã€‚è€ŒAFL++åˆ™æ˜¯ä½¿ç”¨çš„ä¸€ç§å…±äº«è¡¨ï¼Œæ¯ä¸€ä¸ªæŒ‡ä»¤éƒ½è®°å½•ä»–çš„å‰256æ¬¡æ‰§è¡Œçš„æ“ä½œæ•°ã€‚</p>
<h4 id="3-2-3-MOpt-Mutator">3.2.3 MOpt Mutator</h4>
<p>AFL++ä¸­ä¹Ÿç¼åˆäº†MOptçš„Pilotå’ŒCoreæ¨¡å—ã€‚å¹¶ä¸”å¯ä»¥å’ŒInput-to-Stateç»“åˆã€‚</p>
<h3 id="3-3-Instrumentations">3.3 Instrumentations</h3>
<p>Afl++æ”¯æŒå‡ ç§æ’æ¡©åç«¯ï¼šLLVMã€GCCã€QEMUã€Unicornå’ŒQBDIã€‚å¦‚è¡¨ä¸€æ‰€ç¤ºï¼Œæ˜¯å¯¹ç¬¬ä¸‰èŠ‚ä¸­è®¨è®ºçš„åŠŸèƒ½çš„å®ç°çŠ¶æ€ã€‚</p>
<p><img src="https://i.loli.net/2021/04/20/p43RiIknfS7wuma.png" alt="image-20210420201439867"></p>
<p>åœ¨æ’æ¡©ä¸Šï¼ŒAFL++è¿˜è§£å†³äº†è¾¹hit countæº¢å‡ºçš„é—®é¢˜ã€‚å› ä¸ºåœ¨AFLä¸­ï¼Œè¾¹åªä¼šè®°å½•åˆ°255ã€‚</p>
<p>ä½œè€…æä¾›äº†ä¸¤ç§æ–¹æ³•è§£å†³è¿™ä¸ªé—®é¢˜ï¼š</p>
<ol>
<li>NeverZeroï¼ŒåŠ ä¸€ä¸ªè¿›ä½æ ‡å¿—ã€‚NeverZeroå¯ä»¥æé«˜fuzzerçš„è¡¨ç°æ€§èƒ½ã€‚</li>
<li>Saturated Countersï¼šå½“è®¡æ•°è¶…è¿‡255æ—¶ï¼Œå°±åœåœ¨255ã€‚è¿™ä¸ªåšæ³•ï¼Œä¸æ¨èï¼Œåè€Œä¼šè®©fuzzerçš„æ€§èƒ½å˜å·®ã€‚</li>
</ol>
<h2 id="4-Evaluation-Use-Cases">4 Evaluation Use Cases</h2>
<p>ä½œè€…é€‰å–äº†å¦‚ä¸‹å…­ç§AFL++é…ç½®ï¼Œå¹¶åˆ©ç”¨FuzzBenchæ¥è¯„ä¼°æ€§èƒ½ã€‚</p>
<p>FuzzBenchä¸ºæ‰€æœ‰æ„Ÿå…´è¶£çš„é¡¹ç›®æä¾›å›ºå®šçš„21ä¸ªç›®æ ‡çš„æ¨¡ç³Šè¯„ä¼°ï¼Œä½œè€…æ ¹æ®ä»–ä»¬çš„ç‰¹å¾ä»21ä¸ªä¸­æŒ‘é€‰äº†9ä¸ªæ˜¾ç¤ºå‡ºä¸åŒçš„è¡Œä¸ºçš„ç›®æ ‡ã€‚</p>
<ol>
<li><strong>Default</strong> : AFL with some fixes</li>
<li><strong>MOpt</strong>: 3.2.3æåˆ°çš„æœ‰æ•ˆçš„çªå˜å™¨</li>
<li><strong>Ngram4</strong>: å¦ä¸€ç§å·¥å…·ï¼Œå°†4ä¸ªåŸºæœ¬å—è§£é‡Šä¸ºå”¯ä¸€è·¯å¾„ã€‚</li>
<li><strong>RedQueen</strong>: Fuzzerçš„å¦ä¸€ä¸ªåé¦ˆé€šé“ï¼Œå¯ä»¥åˆ°è¾¾æ›´æ·±çš„æ·±åº¦ã€‚</li>
<li><strong>Ngram4, Rare</strong>: Ngram4 å’Œ Rare Schedule ç»„åˆã€‚</li>
<li><strong>MOpt, RedQueen</strong> MOpt mutation å’Œ RedQueen ç»„åˆ</li>
</ol>
<p>åˆ©ç”¨ä¸Šè¿°å…­ç»„ç»„åˆï¼Œä½œè€…å°è¯•è¯æ˜ï¼š</p>
<ul>
<li>æŠŠMOptå’ŒNgram4å½“æˆå¯èƒ½çš„æŠ€æœ¯å®ä¾‹ï¼Œé‚£ä¹ˆæŠŠä»–ä»¬ç»„åˆèµ·æ¥èƒ½äº§ç”Ÿæœ‰ç”¨çš„æ•ˆæœã€‚</li>
<li>åœ¨è¿è¡ŒæœŸé—´ï¼Œæ‰€æœ‰çš„fuzzingè¡Œä¸ºéƒ½æ˜¯é’ˆå¯¹ç‰¹å®šè¡Œä¸ºçš„ï¼Œå› æ­¤é€‰æ‹©åˆé€‚çš„é…ç½®éå¸¸é‡è¦ã€‚</li>
</ul>
<p><strong>RedQueen</strong> å¦‚ä¸‹å›¾gæ‰€ç¤ºï¼ŒRedQueenèƒ½ç»•è¿‡å…¶ä»–é…ç½®ä¸èƒ½ç»•è¿‡çš„roadblocksï¼Œç”±äºI2Sæ›¿æ¢ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹ï¼ŒMOptå˜å¼‚æœ‰åŠ©äºè¿›ä¸€æ­¥å¢åŠ è¦†ç›–èŒƒå›´ã€‚</p>
<p><strong>MOpt</strong> MOptè¦ä¹ˆå¾ˆæˆåŠŸï¼Œè¦ä¹ˆå¾ˆå¤±è´¥ã€‚æ¯”å¦‚å›¾hï¼ŒMOptçªç„¶å¼€å§‹æ‰¾åˆ°å¤§é‡çš„æ–°è¦†ç›–ï¼Œå¹¶ä¸”æ€§èƒ½è¿œè¿œè¶…è¿‡å…¶ä»–ä»»ä½•é…ç½®ã€‚</p>
<p>åœ¨ç›®æ ‡æ˜¯harfbuzzæ—¶ï¼ŒRedQueen å’Œ MOpt çš„ç»„åˆå–å¾—äº†æ˜æ˜¾çš„æ•ˆæœï¼Œå¦‚å›¾eæ‰€ç¤ºï¼ŒRedQueenä¿è¯æ¢ç´¢æ·±åº¦ï¼ŒMOPTå¢åŠ äº†postiveçš„ç»“æœã€‚</p>
<p>åœ¨ç›®æ ‡æ˜¯ libjpeg-turbo æ—¶ï¼ŒMOptå¯¹RedQueençš„è¡Œä¸ºæœ‰è¾ƒé«˜çš„å½±å“ï¼Œå¦‚å›¾dæ‰€ç¤ºã€‚</p>
<p>ä½†æ˜¯ï¼Œåœ¨ç›®æ ‡æ˜¯ lcms æ—¶ï¼ŒRedQueençš„ç§¯ææ•ˆæœå’ŒMOptçš„æ¶ˆææ•ˆæœæŠµæ¶ˆäº†ã€‚</p>
<p><strong>Ngram</strong> Ngramä¹Ÿæ˜¯ä¸€ç§å¯èƒ½åˆ°è¾¾æ›´æ·±å±‚æ¬¡çš„æœ‰æ•ˆæ–¹æ³•ã€‚å¦‚å›¾iå’Œcæ‰€ç¤ºï¼Œå…¶ä¸­ç›®æ ‡æ˜¯libxml2æ—¶ï¼ŒMOptå’ŒRedQueençš„è¡¨ç°éƒ½ä¸ä½³ï¼Œè€ŒNgramæ•ˆæœå‡ºè‰²ã€‚ä½†æ˜¯ä¹Ÿå’Œå…¶ä»–é…ç½®ä¸€æ ·Ngramä¹Ÿæœ‰è¡¨ç°æ¯”é»˜è®¤é…ç½®è·Ÿå·®çš„æ—¶å€™ã€‚</p>
<p><img src="https://i.loli.net/2021/04/21/JnhMv7ImLTzfNqu.png" alt="image-20210421102430579"></p>
<h3 id="4-1-AFL-Optimal">4.1 AFL++ Optimal</h3>
<p>åŸºäºä¸Šè¿°è¯„ä¼°ï¼Œä½œè€…åˆå¯¹é…ç½®è¿›è¡Œäº†å¾®è°ƒï¼Œè¢«ç§°ä¸ºAFL++ Optimalã€‚å¹¶å¯¹21ä¸ªå¯ç”¨ç›®æ ‡ä¸­çš„13ä¸ªæ‰‹å·¥åˆ¶ä½œå¹¶å¯ç”¨äº†AFL ++ Optimalã€‚ è¿™æ ·ï¼Œæ¯ä¸ªç›®æ ‡çš„æœ€é«˜ä¸­å€¼è¦†ç›–ç‡çš„ç™¾åˆ†æ¯”å¹³å‡æé«˜äº†7ï¼…ï¼ŒAFL ++ Optimalé€šå¸¸ä¼˜äºFuzzBench3ä¸Šçš„æ‰€æœ‰å…¶ä»–æ¨¡ç³Šæµ‹è¯•ã€‚</p>
<h2 id="5-Future-Work">5 Future Work</h2>
<p>å°½ç®¡AFL ++é¡¹ç›®åœ¨è¿‡å»çš„ä¸€å¹´ä¸­å–å¾—äº†è‰¯å¥½çš„è¿›å±•ï¼Œä½†ä»æœ‰æ›´å¤§çš„ç ”ç©¶å’Œå·¥ç¨‹é—®é¢˜éœ€è¦è§£å†³ã€‚</p>
<h3 id="5-1-Scaling">5.1 Scaling</h3>
<p>AFL++å¯¹äºå¤šçº¿ç¨‹çš„æ‰©å±•è¿˜ä¸å¤Ÿç†æƒ³ï¼Œå¹¶ä¸”æœ‰äº›ä¾èµ–forkçš„syscallï¼Œæ‰€ä»¥å¤§éƒ¨åˆ†æ—¶é—´èŠ±åœ¨äº†å†…æ ¸ä¸Šï¼Œæ‰€ä»¥ä¸‹ä¸€æ­¥æ˜¯å¤šçº¿ç¨‹æ”¯æŒé™ä½å¼€é”€ã€‚</p>
<h3 id="5-2-Collision-Free-instrumentation">5.2 Collision-Free instrumentation</h3>
<p>AFLæä¾›çš„åŸå§‹å·¥å…·ä»¥ä¸€ç§å¯èƒ½å‘ç”Ÿå†²çªçš„æ–¹å¼æ•£åˆ—å½“å‰è·³è½¬çš„èµ·å§‹åœ°å€å’Œç›®æ ‡åœ°å€ã€‚è¿™è¢«è®¤ä¸ºæ˜¯é€Ÿåº¦å’Œå‡†ç¡®æ€§ä¹‹é—´çš„æŠ˜è¡·ã€‚</p>
<h3 id="5-3-Static-Analysis-for-Optimal-Fuzz-Settings">5.3 Static Analysis for Optimal Fuzz Settings</h3>
<p>Fuzzingçš„æœ€ä½³æ–¹æ¡ˆå¾ˆå¤§ç¨‹åº¦ä¸Šå–å†³äºç›®æ ‡ï¼Œæ‰€ä»¥æœªæ¥çš„å·¥ä½œå¯ä»¥é€šè¿‡å¯¹ç›®æ ‡çš„é™æ€åˆ†ææ‰¾åˆ°ä¸€ä¸ªå¯èƒ½æœ€ä¼˜çš„é€‰é¡¹ï¼Œæ¯”å¦‚å¤§é‡çš„ strcmp å¯èƒ½æ˜¯é€‚åˆRedQueençš„è¿¹è±¡ã€‚</p>
<h3 id="5-4-Plug-in-System">5.4 Plug-in System</h3>
<p>å°½ç®¡Custom Mutatorå·²ç»ä¸ºç ”ç©¶äººå‘˜æä¾›äº†å¾ˆå¤§çš„çµæ´»æ€§ï¼Œä½†ç›®æ ‡æ˜¯æ·»åŠ é¢å¤–çš„æ’ä»¶åŠŸèƒ½ï¼Œä»¥æ›¿æ¢æˆ–æ·»åŠ æ„å»ºå—(å¦‚è°ƒåº¦å™¨ã€æ‰§è¡Œå™¨å’Œé˜Ÿåˆ—)çš„åŠŸèƒ½ã€‚</p>
<h2 id="6-Conclusion">6 Conclusion</h2>
<p>AFL++è¯•å›¾é›†æˆæœ€è¿‘è®¸å¤šä¸»è¦çš„æ¨¡ç³Šç ”ç©¶ï¼Œè¿™åœ¨å½“å‰çš„AFL++ä½“ç³»ç»“æ„ä¸­æ˜¯å¯è¡Œçš„ã€‚</p>
<p>åœ¨æµ‹è¯•åï¼Œä½œè€…å‘ç°æå‡ºçš„Fuzzingä¼˜åŒ–éƒ½åªèƒ½é’ˆå¯¹ç‰¹å®šç›®æ ‡ï¼Œè€Œå¯¹å…¶ä»–ç›®æ ‡çš„æ•ˆæœå¯èƒ½ä¸å¤§ç†æƒ³ã€‚</p>
<p>æœ€é‡è¦çš„æ˜¯ï¼ŒAFL++å¼¥åˆäº†å­¦æœ¯ç•Œå’Œè¡Œä¸šä¹‹é—´çš„é¸¿æ²Ÿï¼Œä»¥æ˜“äºä½¿ç”¨çš„æ–¹å¼å‘æ‰€æœ‰äººæä¾›å­¦æœ¯è¿›æ­¥ã€‚</p>
</article><div class="post-copyright"><div class="post-copyright__author"><span class="post-copyright-meta">æ–‡ç« ä½œè€…: </span><span class="post-copyright-info"><a href="mailto:undefined">LJC</a></span></div><div class="post-copyright__type"><span class="post-copyright-meta">æ–‡ç« é€£çµ: </span><span class="post-copyright-info"><a href="https://ljcppp.github.io/2021/05/15/AFL-Combining-Incremental-Steps-of-Fuzzing-Research/">https://ljcppp.github.io/2021/05/15/AFL-Combining-Incremental-Steps-of-Fuzzing-Research/</a></span></div><div class="post-copyright__notice"><span class="post-copyright-meta">ç‰ˆæ¬Šè²æ˜: </span><span class="post-copyright-info">æœ¬éƒ¨è½æ ¼æ‰€æœ‰æ–‡ç« é™¤ç‰¹åˆ¥è²æ˜å¤–ï¼Œå‡æ¡ç”¨ <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" target="_blank">CC BY-NC-SA 4.0</a> è¨±å¯å”è­°ã€‚è½‰è¼‰è«‹è¨»æ˜ä¾†è‡ª <a href="https://ljcppp.github.io" target="_blank">LJC's BLOG</a>ï¼</span></div></div><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/papper-notes/">papper notes</a></div><div class="post_share"><div class="social-share" data-image="/img/Big_Sur_Simple.png" data-sites="facebook,twitter,wechat,weibo,qq"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/social-share.js/dist/css/share.min.css" media="print" onload="this.media='all'"><script src="https://cdn.jsdelivr.net/npm/social-share.js/dist/js/social-share.min.js" defer></script></div></div><div class="post-reward"><div class="reward-button button--animated"><i class="fas fa-qrcode"></i> æ‰“è³</div><div class="reward-main"><ul class="reward-all"><li class="reward-item"><a href="/img/alipay.jpg" target="_blank"><img class="post-qr-code-img" src="/img/alipay.jpg" alt="æ”¯ä»˜å¯¶"/></a><div class="post-qr-code-desc">æ”¯ä»˜å¯¶</div></li></ul></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2021/06/09/SoK-All-You-Ever-Wanted-to-Know-About-x86-x64-Binary-Disassembly-But-Were-Afraid-to-Ask/"><img class="prev-cover" src="/img/Big_Sur_Simple.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">ä¸Šä¸€ç¯‡</div><div class="prev_info">SoK: All You Ever Wanted to Know About x86/x64 Binary Disassembly But Were Afraid to Ask</div></div></a></div><div class="next-post pull-right"><a href="/2021/04/21/Writeup%20for%20plaidCTF/"><img class="next-cover" src="/img/Big_Sur_Simple.png" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">ä¸‹ä¸€ç¯‡</div><div class="next_info">Writeup for plaidCTF</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span> ç›¸é—œæ¨è–¦</span></div><div class="relatedPosts-list"><div><a href="/2021/06/09/SoK-All-You-Ever-Wanted-to-Know-About-x86-x64-Binary-Disassembly-But-Were-Afraid-to-Ask/" title="SoK: All You Ever Wanted to Know About x86/x64 Binary Disassembly But Were Afraid to Ask"><img class="cover" src="/img/Big_Sur_Simple.png" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2021-06-09</div><div class="title">SoK: All You Ever Wanted to Know About x86/x64 Binary Disassembly But Were Afraid to Ask</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="card-info-avatar is-center"><img class="avatar-img" src="/img/avatar.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/><div class="author-info__name">LJC</div><div class="author-info__description">è‡ªé—­å¤±è´¥å°å­¦ç”ŸğŸ¤¡</div></div><div class="card-info-data"><div class="card-info-data-item is-center"><a href="/archives/"><div class="headline">æ–‡ç« </div><div class="length-num">8</div></a></div><div class="card-info-data-item is-center"><a href="/tags/"><div class="headline">æ¨™ç±¤</div><div class="length-num">5</div></a></div></div><a class="button--animated" id="card-info-btn" target="_blank" rel="noopener" href="https://github.com/ljcppp"><i class="fab fa-github"></i><span>Follow Me</span></a><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/ljcppp" target="_blank" title="Github"><i class="fab fa-github"></i></a><a class="social-icon" href="/ljcppp@qq.com" target="_blank" title="Email"><i class="fas fa-envelope"></i></a></div></div><div class="card-widget card-announcement"><div class="item-headline"><i class="fas fa-bullhorn card-announcement-animation"></i><span>å…¬å‘Š</span></div><div class="announcement_content">å¥½ é¥¿ å•Š</div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>ç›®éŒ„</span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#Introduction"><span class="toc-number">1.</span> <span class="toc-text">Introduction</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#2-State-of-the-Art"><span class="toc-number">2.</span> <span class="toc-text">2 State-of-the-Art</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#2-1-American-Fuzzy-Lop"><span class="toc-number">2.1.</span> <span class="toc-text">2.1 American Fuzzy Lop</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-1-Coverage-Guided-Feedback"><span class="toc-number">2.1.1.</span> <span class="toc-text">2.1.1 Coverage Guided Feedback</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-2-Mutation"><span class="toc-number">2.1.2.</span> <span class="toc-text">2.1.2 Mutation</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-3-Forkserver"><span class="toc-number">2.1.3.</span> <span class="toc-text">2.1.3 Forkserver</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-1-4-Persistent-Mode"><span class="toc-number">2.1.4.</span> <span class="toc-text">2.1.4 Persistent Mode</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-2-Smart-Scheduling"><span class="toc-number">2.2.</span> <span class="toc-text">2.2 Smart Scheduling</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-1-AFLFast"><span class="toc-number">2.2.1.</span> <span class="toc-text">2.2.1 AFLFast</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-2-2-MOpt"><span class="toc-number">2.2.2.</span> <span class="toc-text">2.2.2 MOpt</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-3-Bypassing-Roadblocks"><span class="toc-number">2.3.</span> <span class="toc-text">2.3 Bypassing Roadblocks</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-1-LAF-Intel"><span class="toc-number">2.3.1.</span> <span class="toc-text">2.3.1 LAF-Intel</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#2-3-2-RedQueen"><span class="toc-number">2.3.2.</span> <span class="toc-text">2.3.2 RedQueen</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#2-4-Mutate-Structured-Inputs"><span class="toc-number">2.4.</span> <span class="toc-text">2.4 Mutate Structured Inputs</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#2-4-1-AFLSmart"><span class="toc-number">2.4.1.</span> <span class="toc-text">2.4.1 AFLSmart</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#3-A-New-Baseline-for-Fuzzing"><span class="toc-number">3.</span> <span class="toc-text">3 A New Baseline for Fuzzing</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#3-1-Seed-Scheduling"><span class="toc-number">3.1.</span> <span class="toc-text">3.1 Seed Scheduling</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-2-Mutators"><span class="toc-number">3.2.</span> <span class="toc-text">3.2 Mutators</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-1-Custom-Mutator-API"><span class="toc-number">3.2.1.</span> <span class="toc-text">3.2.1 Custom Mutator API</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-2-Input-To-State-Mutator"><span class="toc-number">3.2.2.</span> <span class="toc-text">3.2.2 Input-To-State Mutator</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#3-2-3-MOpt-Mutator"><span class="toc-number">3.2.3.</span> <span class="toc-text">3.2.3 MOpt Mutator</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#3-3-Instrumentations"><span class="toc-number">3.3.</span> <span class="toc-text">3.3 Instrumentations</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#4-Evaluation-Use-Cases"><span class="toc-number">4.</span> <span class="toc-text">4 Evaluation Use Cases</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#4-1-AFL-Optimal"><span class="toc-number">4.1.</span> <span class="toc-text">4.1 AFL++ Optimal</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#5-Future-Work"><span class="toc-number">5.</span> <span class="toc-text">5 Future Work</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#5-1-Scaling"><span class="toc-number">5.1.</span> <span class="toc-text">5.1 Scaling</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-2-Collision-Free-instrumentation"><span class="toc-number">5.2.</span> <span class="toc-text">5.2 Collision-Free instrumentation</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-3-Static-Analysis-for-Optimal-Fuzz-Settings"><span class="toc-number">5.3.</span> <span class="toc-text">5.3 Static Analysis for Optimal Fuzz Settings</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#5-4-Plug-in-System"><span class="toc-number">5.4.</span> <span class="toc-text">5.4 Plug-in System</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#6-Conclusion"><span class="toc-number">6.</span> <span class="toc-text">6 Conclusion</span></a></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>æœ€æ–°æ–‡ç« </span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2021/06/09/SoK-All-You-Ever-Wanted-to-Know-About-x86-x64-Binary-Disassembly-But-Were-Afraid-to-Ask/" title="SoK: All You Ever Wanted to Know About x86/x64 Binary Disassembly But Were Afraid to Ask"><img src="/img/Big_Sur_Simple.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SoK: All You Ever Wanted to Know About x86/x64 Binary Disassembly But Were Afraid to Ask"/></a><div class="content"><a class="title" href="/2021/06/09/SoK-All-You-Ever-Wanted-to-Know-About-x86-x64-Binary-Disassembly-But-Were-Afraid-to-Ask/" title="SoK: All You Ever Wanted to Know About x86/x64 Binary Disassembly But Were Afraid to Ask">SoK: All You Ever Wanted to Know About x86/x64 Binary Disassembly But Were Afraid to Ask</a><time datetime="2021-06-09T07:22:53.000Z" title="ç™¼è¡¨æ–¼ 2021-06-09 15:22:53">2021-06-09</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/05/15/AFL-Combining-Incremental-Steps-of-Fuzzing-Research/" title="AFL++: Combining Incremental Steps of Fuzzing Research"><img src="/img/Big_Sur_Simple.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="AFL++: Combining Incremental Steps of Fuzzing Research"/></a><div class="content"><a class="title" href="/2021/05/15/AFL-Combining-Incremental-Steps-of-Fuzzing-Research/" title="AFL++: Combining Incremental Steps of Fuzzing Research">AFL++: Combining Incremental Steps of Fuzzing Research</a><time datetime="2021-05-15T07:14:52.000Z" title="ç™¼è¡¨æ–¼ 2021-05-15 15:14:52">2021-05-15</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/04/21/Writeup%20for%20plaidCTF/" title="Writeup for plaidCTF"><img src="/img/Big_Sur_Simple.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Writeup for plaidCTF"/></a><div class="content"><a class="title" href="/2021/04/21/Writeup%20for%20plaidCTF/" title="Writeup for plaidCTF">Writeup for plaidCTF</a><time datetime="2021-04-21T05:12:27.000Z" title="ç™¼è¡¨æ–¼ 2021-04-21 13:12:27">2021-04-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/04/11/Learning%20FRIDA%20with%20Examples/" title="Learning FRIDA with Examples"><img src="/img/Big_Sur_Simple.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Learning FRIDA with Examples"/></a><div class="content"><a class="title" href="/2021/04/11/Learning%20FRIDA%20with%20Examples/" title="Learning FRIDA with Examples">Learning FRIDA with Examples</a><time datetime="2021-04-11T09:08:37.000Z" title="ç™¼è¡¨æ–¼ 2021-04-11 17:08:37">2021-04-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2021/03/25/Learning%20Angr%20with%20Examples/" title="Learning Angr with Examples"><img src="/img/Big_Sur_Simple.png" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Learning Angr with Examples"/></a><div class="content"><a class="title" href="/2021/03/25/Learning%20Angr%20with%20Examples/" title="Learning Angr with Examples">Learning Angr with Examples</a><time datetime="2021-03-25T06:06:52.000Z" title="ç™¼è¡¨æ–¼ 2021-03-25 14:06:52">2021-03-25</time></div></div></div></div></div></div></main><footer id="footer"><div id="footer-wrap"><div class="copyright">&copy;2020 - 2021 By LJC</div><div class="framework-info"><span>æ¡†æ¶ </span><a target="_blank" rel="noopener" href="https://hexo.io">Hexo</a><span class="footer-separator">|</span><span>ä¸»é¡Œ </span><a target="_blank" rel="noopener" href="https://github.com/jerryc127/hexo-theme-butterfly">Butterfly</a></div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="é–±è®€æ¨¡å¼"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="æ·ºè‰²å’Œæ·±è‰²æ¨¡å¼è½‰æ›"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="å–®æ¬„å’Œé›™æ¬„åˆ‡æ›"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside_config" type="button" title="è¨­å®š"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="ç›®éŒ„"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="å›åˆ°é ‚éƒ¨"><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js"></script><script src="/js/main.js"></script><script>var preloader = {
  endLoading: () => {
    document.body.style.overflow = 'auto';
    document.getElementById('loading-box').classList.add("loaded")
  },
  initLoading: () => {
    document.body.style.overflow = '';
    document.getElementById('loading-box').classList.remove("loaded")

  }
}
window.addEventListener('load',preloader.endLoading())</script><div class="js-pjax"><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex@latest/dist/katex.min.css"><script src="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.js"></script><link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/npm/katex-copytex@latest/dist/katex-copytex.min.css"><script>(() => {
  document.querySelectorAll('#article-container span.katex-display').forEach(item => {
    btf.wrap(item, 'div', '', 'katex-wrap')
  })
})()</script></div><script defer="defer" id="ribbon" src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1/dist/canvas-ribbon.min.js" size="150" alpha="0.6" zIndex="-1" mobile="false" data-click="true"></script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script></div></body></html>